{
  "$schema": "<relative path to createFormUI.schema.json>",
  "view": {
    "kind": "Form",
    "properties": {
      "title": "Azure Lite Landing Zone",
      "steps": [
        {
          "name": "intro",
          "label": "README",
          "elements": [
            {
              "name": "infoMessage",
              "type": "Microsoft.Common.InfoBox",
              "visible": true,
              "options": {
                "icon": "Info",
                "text": "This template will deloy a Landing Zone intended for PoC/Pilot purpose only. Once testing of the PoC/Pilot has been completed, delete the resources and re-create the landing zone according to Cloug Adoption Framework best practices.",
                "uri": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/overview"
              }
            },
            {
              "name": "pocAccept",
              "type": "Microsoft.Common.CheckBox",
              "label": "I acknowedge the conditions of this deployment.",
              "constraints": {
                "required": true,
                "validationMessage": "Please acknowledge the PoC/Pilot conditions."
              }
            }
          ]
        },
        {
          "name": "basics",
          "label": "Deployment location",
          "elements": [
            {
              "name": "resourceScope",
              "type": "Microsoft.Common.ResourceScope"
            }
          ]
        },
        {
          "name": "required",
          "label": "Required Components",
          "subLabel": {
            "preValidation": "Configure the virtual machine's resources and settings",
            "postValidation": "Done"
          },
          "bladeTitle": "VPN Settings",
          "elements": [
            {
              "name": "vpnMessage",
              "type": "Microsoft.Common.InfoBox",
              "visible": true,
              "options": {
                "icon": "Info",
                "text": "TODO: Expose networking settins for VPN Gateway. For now, the VM settings below will be used for test VM.",
                "uri": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/overview"
              }
            },
            {
              "name": "vnet",
              "type": "Microsoft.Network.VirtualNetworkCombo",
              "label": {
                "virtualNetwork": "Virtual Network",
                "subnets": "Subnets"
              },
              "toolTip": {
                "virtualNetwork": "To use an existing VNET, 3 subnets must already exist for Bastion, Gateway and Virtual Machines. For a new VNET, the template will create them.",
                "subnets": ""
              },
              "options": {
                "hideExisting": false
              },
              "defaultValue": {
                "name": "azure-poc-vnet",
                "addressPrefixSize": "/16"
              },
              "constraints": {
                "minAddressPrefixSize": "/24"
              },
              "subnets": {
                "subnet0": {
                  "label": "Gateway Subnet",
                  "defaultValue": {
                    "name": "gatewaySubnet",
                    "addressPrefixSize": "/24"
                  },
                  "constraints": {
                    "minAddressPrefixSize": "/29",
                    "minAddressCount": 1,
                    "requireContiguousAddresses": true
                  }
                },
                "subnet1": {
                  "label": "Bastion Subnet",
                  "defaultValue": {
                    "name": "azureBastionSubnet",
                    "addressPrefixSize": "/24"
                  },
                  "constraints": {
                    "minAddressPrefixSize": "/29",
                    "minAddressCount": 4,
                    "requireContiguousAddresses": true
                  }
                },
                "subnet2": {
                  "label": "Virtual Machine Subnet",
                  "defaultValue": {
                    "name": "virtualMachineSubnet",
                    "addressPrefixSize": "/24"
                  },
                  "constraints": {
                    "minAddressPrefixSize": "/29",
                    "minAddressCount": 4,
                    "requireContiguousAddresses": true
                  }
                }
              }
            },
            {
              "name": "adminUsername",
              "type": "Microsoft.Compute.UserNameTextBox",
              "label": "Admin Username",
              "defaultValue": "",
              "toolTip": "",
              "constraints": {
                "required": true,
                "regex": "^[a-z0-9A-Z]{1,30}$",
                "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
              },
              "osPlatform": "Windows",
              "visible": true
            },
            {
              "name": "adminPassword",
              "type": "Microsoft.Compute.CredentialsCombo",
              "label": {
                "password": "Password",
                "confirmPassword": "Confirm password"
              },
              "toolTip": {
                "password": ""
              },
              "constraints": {
                "required": true,
                "customPasswordRegex": "^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])[\\w~@#$%^&*+=|{}:;!.?\\()\\[\\]-]{8,}$",
                "customValidationMessage": "The password must contain at least 8 characters, with at least 1 uppercase, 1 lowercase and 1 number."
              },
              "options": {
                "hideConfirmation": false
              },
              "osPlatform": "Windows",
              "visible": true
            }
          ]
        },
        {
          "name": "optional",
          "label": "Optional Components",
          "subLabel": {
            "preValidation": "Configure the virtual machine's resources and settings",
            "postValidation": "Done"
          },
          "bladeTitle": "VM Settings",
          "elements": [
            {
              "name": "vmText",
              "type": "Microsoft.Common.TextBlock",
              "visible": true,
              "options": {
                "text": "List possible optional component(s) here: I'm thinking an Azure Firewall to start off with.",
                "link": {
                  "label": "Learn more",
                  "uri": "https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/overview"
                }
              }
            }
          ]
        }
      ]
    },
    "outputs": {
      "parameters": {
        "adminUsername": "[steps('required').adminUsername]",
        "adminPassword": "[steps('required').adminPassword.password]",
        "addressSpace": "[steps('required').vnet.addressPrefixes]",
        "gatewaySubnetPrefix": "[steps('required').vnet.subnets.subnet0.addressPrefix]",
        "bastionSubnetPrefix": "[steps('required').vnet.subnets.subnet1.addressPrefix]",
        "vmSubnetPrefix": "[steps('required').vnet.subnets.subnet2.addressPrefix]"
      },
      "kind": "ResourceGroup",
      "location": "[steps('basics').resourceScope.location.name]",
      "resourceGroupId": "[steps('basics').resourceScope.resourceGroup.id]"
    }
  }
}